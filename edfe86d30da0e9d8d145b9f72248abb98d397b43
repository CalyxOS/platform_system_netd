{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a98cb97a_9cc42917",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 223,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-01-17T13:27:22Z",
      "side": 1,
      "message": "I wonder if just changing this to\n\n\"-A bw_costly_shared -j bw_happy_box\"\n\nwould fix things.",
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3c89a5d_dddefd7f",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-01-17T13:12:52Z",
      "side": 1,
      "message": "My understanding of how background data and data saver work is:\n1. normally only applies to metered network (bw_costly_shared)\n2. which, if it has not matches jumps to a penalty chain (bw_penalty_box / restrict background data toggle)\n3. which, if it has no matches jumps to an allowlist chain (bw_happy_box / unrestricted data)\n4. which, if it has no matches jumps to data saver\n5. which, if it has no matches returns\n\nNow since we apply bw_penalty_box to bw_INPUT, bw_FORWARD and bw_OUTPUT and not just to bw_costly_shared we also apply unrestricted data and data saver to them not just background data restrictions",
      "range": {
        "startLine": 225,
        "startChar": 16,
        "endLine": 225,
        "endChar": 29
      },
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "53d19423_2b280cfd",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-01-17T13:19:49Z",
      "side": 1,
      "message": "In other words, with this change I believe it is not only restrict background data that applies globally but unrestricted data usage and data saver too",
      "parentUuid": "b3c89a5d_dddefd7f",
      "range": {
        "startLine": 225,
        "startChar": 16,
        "endLine": 225,
        "endChar": 29
      },
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8777d8ed_4336e9e3",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-01-17T13:24:56Z",
      "side": 1,
      "message": "https://linux.die.net/man/8/iptables\n\n-A, --append chain rule-specification\nAppend one or more rules to the end of the selected chain.\n\n-j, --jump target\nThis specifies the target of the rule; i.e., what to do if the packet matches it.\n\n1. Ack\n2. no matches*, Ack\n3. Ack\n4. Ack\n5. Ack\n\nI see what you mean. 11 was the same, https://review.calyxos.org/c/CalyxOS/platform_system_netd/+/1957/1/server/BandwidthController.cpp\n\nWe should do an `iptables -L` diff with and without this change.\n\nAlso, does the actual behaviour on device match your hypothesis? Could you test?",
      "parentUuid": "53d19423_2b280cfd",
      "range": {
        "startLine": 225,
        "startChar": 16,
        "endLine": 225,
        "endChar": 29
      },
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "76416837_88481db1",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-01-17T13:28:26Z",
      "side": 1,
      "message": "Concerning testing, it is reproducible with the same test as in the commit message but instead of doing the per-app background data toggle, just enabling data saver",
      "parentUuid": "8777d8ed_4336e9e3",
      "range": {
        "startLine": 225,
        "startChar": 16,
        "endLine": 225,
        "endChar": 29
      },
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05d7c704_18de6637",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-01-17T13:33:30Z",
      "side": 1,
      "message": "I know it\u0027s not the intentional behaviour but I think it\u0027s a potentially interesting one personally",
      "parentUuid": "76416837_88481db1",
      "range": {
        "startLine": 225,
        "startChar": 16,
        "endLine": 225,
        "endChar": 29
      },
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fecb3d8e_1a46f7ee",
        "filename": "server/BandwidthController.cpp",
        "patchSetId": 4
      },
      "lineNbr": 488,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-01-17T13:24:56Z",
      "side": 1,
      "message": "Looks like I also missed this one in 12.",
      "revId": "edfe86d30da0e9d8d145b9f72248abb98d397b43",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    }
  ]
}